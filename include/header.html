<div class="header-inner">
  <!-- 로고 -->
  <h1 class="logo">
    <a href="./index.html">
      <img src="/assets/images/common/logo.png" alt="스마트 그린푸드 로고" class="pc_logo" />
      <img src="/assets/images/common/logo_mo.png" alt="스마트 그린푸드 로고" class="mo_logo" />
    </a>
  </h1>

  <!-- 상단 유틸리티 -->
  <div class="header-top">
  <div class="utility-links">
    <button type="button">글자크기</button>

    <div class="font_size_controller">
      <button type="button" class="btn_font_size" data-action="increase">
        <span class="blind">글자 크게</span> +
      </button>
      <button type="button" class="btn_font_size" data-action="decrease">
        <span class="blind">글자 작게</span> -
      </button>
    </div>

    <button type="button"
      onclick="location.href='https://www.smartgreenfood.org/jsp/front/sitemap.jsp'">
      사이트맵
    </button>
  </div>
</div>


  <!-- 메인 네비게이션 -->
  <div class="header-main">
    <nav class="main-nav">
      <ul>
        <li><a href="#">정보공개</a></li>
        <li data-menu="menu-1"><a href="#">스마트그린푸드 소개</a></li>
        <li data-menu="menu-2"><a href="#">대응사업</a></li>
        <li data-menu="menu-3"><a href="#">생활속의 탄소이야기</a></li>
        <li data-menu="menu-4"><a href="#">그린소식</a></li>
      </ul>
    </nav>
  </div>

  <!-- 모바일 네비게이션 -->
  <div class="mo_nav_wrap">
    <button type="button" class="btn_menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <nav class="gnb">
      <ul class="gnb_depth1">
        <li>
          <a href="javascript:void(0)" title="정보공개" class="btn_depth1">정보공개</a>
        </li>
        <li class="has_depth2">
          <button type="button" class="btn_depth1">스마트그린푸드소개</button>
          <div class="depth2_wrap">
            <ul class="depth2_list">
              <li><a href="javascript:void(0)" title="기후변화" class="btn_depth2">기후변화</a></li>
              <li><a href="javascript:void(0)" title="온실가스배출량" class="btn_depth2">온실가스배출량</a></li>
              <li><a href="javascript:void(0)" title="농업부문 대응전략" class="btn_depth2">농업부문 대응전략</a></li>
              <li><a href="javascript:void(0)" title="기관소개" class="btn_depth2">기관소개</a></li>
            </ul>
          </div>
        </li>
        <li class="has_depth2">
          <button type="button" class="btn_depth1">대응사업</button>
          <div class="depth2_wrap">
            <ul class="depth2_list">
              <li class="has_depth3">
                <button type="button" class="btn_depth2">농업 농촌 온실가스 감축사업</button>
                <div class="depth3_wrap">
                  <ul class="depth3_list">
                    <li><a href="javascript:void(0)" class="btn_depth3" title="사업소개">사업소개</a></li>
                    <li><a href="javascript:void(0)" class="btn_depth3" title="저탄소 농업기술">저탄소 농업기술</a></li>
                    <li><a href="javascript:void(0)" class="btn_depth3" title="사업절차">사업절차</a></li>
                    <li><a href="javascript:void(0)" class="btn_depth3" title="저탄소 농업기술 방법론">저탄소 농업기술 방법론</a></li>
                    <li><a href="javascript:void(0)" class="btn_depth3" title="관련동향">관련동향</a></li>
                  </ul>
                </div>
              </li>
              <li class="has_depth3">
                <button type="button" class="btn_depth2">저탄소농산물인증제</button>
                <div class="depth3_wrap">
                  <ul class="depth3_list">
                    <li><a href="javascript:void(0)" class="btn_depth3" title="인증기관">인증기관</a></li>
                    <li><a href="javascript:void(0)" class="btn_depth3" title="인증절차">인증절차</a></li>
                  </ul>
                </div>
              </li>
              <li class="has_depth3">
                <button type="button" class="btn_depth2">온실가스 목표관리제</button>
                <div class="depth3_wrap">
                  <ul class="depth3_list">
                    <li><a href="javascript:void(0)" class="btn_depth3" title="관리제도 안내">관리제도 안내</a></li>
                    <li><a href="javascript:void(0)" class="btn_depth3" title="관련 법규">관련 법규</a></li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </li>
        <li class="has_depth2">
          <button type="button" class="btn_depth1">생활속의 탄소이야기</button>
          <div class="depth2_wrap">
            <ul class="depth2_list">
              <li><a href="javascript:void(0)" title="농산물 수입과 탄소" class="btn_depth2">농산물 수입과 탄소</a></li>
              <li><a href="javascript:void(0)" title="밥상의 탄소발자국" class="btn_depth2">밥상의 탄소발자국</a></li>
              <li><a href="javascript:void(0)" title="지구를 지키는 농업" class="btn_depth2">지구를 지키는 농업</a></li>
            </ul>
          </div>
        </li>
        <li class="has_depth2">
          <button type="button" class="btn_depth1">그린소식</button>
          <div class="depth2_wrap">
            <ul class="depth2_list">
              <li><a href="javascript:void(0)" title="공지사항" class="btn_depth2">공지사항</a></li>
              <li><a href="javascript:void(0)" title="자료실" class="btn_depth2">자료실</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </nav>
  </div>
</div>

<!-- 드롭다운 메뉴들 (header 밖) -->
<div class="submenu-dropdown" data-menu="menu-1">
  <div class="header-inner">
    <div class="submenu-content flex_sb">
      <div class="leaf">
        <span><img src="/assets/images/common/nav_leaf.png" alt="" /></span>
        스마트 그린푸드 소개
      </div>
      <div class="sub_start">
        <ul class="flex_col">
          <li><a href="#">기후변화</a></li>
          <li><a href="#">온실가스배출량</a></li>
          <li><a href="#">농업부문 대응전략</a></li>
          <li><a href="#">기관소개</a></li>
        </ul>
      </div>
      <div class="sub_middle"></div>
      <div class="sub_last">
        <div class="submenu_imgbox">
          <img src="/assets/images/common/nav_1.jpg" alt="" />
        </div>
      </div>
    </div>
  </div>
</div>

<div class="submenu-dropdown" data-menu="menu-2">
  <div class="header-inner">
    <div class="submenu-content flex_sb">
      <div class="leaf">
        <span><img src="/assets/images/common/nav_leaf.png" alt="" /></span>
        대응사업
      </div>
      <div class="sub_start">
        <ul class="flex_col">
          <li data-submenu="submenu-1">
            <a href="#">농업 • 농촌 온실가스 감축사업</a>
          </li>
          <li data-submenu="submenu-2"><a href="#">저탄소농산물인증제</a></li>
          <li data-submenu="submenu-3"><a href="#">온실가스 목표관리제</a></li>
        </ul>
      </div>
      <div class="sub_middle">
        <div class="submenu-detail" data-submenu="submenu-1">
          <ul>
            <li><a href="#">사업 소개</a></li>
            <li><a href="#">저탄소 농업기술</a></li>
            <li><a href="#">사업절차</a></li>
            <li><a href="#">저탄소 농업기술 방법론</a></li>
            <li><a href="#">관련동향</a></li>
          </ul>
        </div>
        <div class="submenu-detail" data-submenu="submenu-2">
          <ul>
            <li><a href="#">인증기관</a></li>
            <li><a href="#">인증절차</a></li>
          </ul>
        </div>
        <div class="submenu-detail" data-submenu="submenu-3">
          <ul>
            <li><a href="#">관리제도 안내</a></li>
            <li><a href="#">관련 법규</a></li>
          </ul>
        </div>
      </div>
      <div class="sub_last">
        <div class="submenu_imgbox">
          <img src="/assets/images/common/nav_4.jpg" alt="" />
        </div>
      </div>
    </div>
  </div>
</div>

<div class="submenu-dropdown" data-menu="menu-3">
  <div class="header-inner">
    <div class="submenu-content flex_sb">
      <div class="leaf">
        <span><img src="/assets/images/common/nav_leaf.png" alt="" /></span>
        생활속의 탄소이야기
      </div>
      <div class="sub_start">
        <ul class="flex_col">
          <li><a href="#">농산물 수입과 탄소</a></li>
          <li><a href="#">밥상의 탄소발자국</a></li>
          <li><a href="#">지구를 지키는 농업</a></li>
        </ul>
      </div>
      <div class="sub_middle"></div>
      <div class="sub_last">
        <div class="submenu_imgbox">
          <img src="/assets/images/common/nav_3.jpg" alt="" />
        </div>
      </div>
    </div>
  </div>
</div>

<div class="submenu-dropdown" data-menu="menu-4">
  <div class="header-inner">
    <div class="submenu-content flexsb">
      <div class="leaf">
        <span><img src="/assets/images/common/nav_leaf.png" alt="" /></span>
        그린소식
      </div>
      <div class="sub_start">
        <ul class="flex_col">
          <li><a href="#">공지사항</a></li>
          <li><a href="#">자료실</a></li>
        </ul>
      </div>
      <div class="sub_middle"></div>
      <div class="sub_last">
        <div class="submenu_imgbox">
          <img src="/assets/images/common/nav_2.jpg" alt="" />
        </div>
      </div>
    </div>
  </div>
</div>


<script>
  const moNavWrapClick = () => {
    const moNavWrap = document.querySelector('.mo_nav_wrap');
    if (!moNavWrap) return;

    const menuBtn = moNavWrap.querySelector('.btn_menu');
    const gnb = moNavWrap.querySelector('.gnb');

    if (!menuBtn || !gnb) return;

    menuBtn.addEventListener('click', () => {
      const isActive = menuBtn.classList.toggle('active');
      gnb.classList.toggle('active', isActive);

      document.body.classList.toggle('is_nav_open', isActive);
    });
  };
  moNavWrapClick();

  const moNavAccordion = () => {
    const moNavWrap = document.querySelector('.mo_nav_wrap');
    if (!moNavWrap) return;

    // depth1 (has_depth2) 아코디언
    const depth1Items = moNavWrap.querySelectorAll('.gnb_depth1 > li.has_depth2');

    depth1Items.forEach((li) => {
      const btn = li.querySelector('.btn_depth1');
      const panel = li.querySelector('.depth2_wrap');
      if (!btn || !panel) return;

      panel.style.maxHeight = '0px';
      panel.dataset.baseHeight = '0';

      btn.addEventListener('click', () => {
        const isThisActive = li.classList.contains('active');

        // 모든 has_depth2 닫기 + 안의 depth3도 초기화
        depth1Items.forEach((otherLi) => {
          const otherPanel = otherLi.querySelector('.depth2_wrap');
          if (otherPanel) {
            otherLi.classList.remove('active');
            otherPanel.style.maxHeight = '0px';
            otherPanel.dataset.baseHeight = '0';
          }

          const depth3Lis = otherLi.querySelectorAll('li.has_depth3');
          depth3Lis.forEach((d3Li) => {
            d3Li.classList.remove('active');
            const d3Panel = d3Li.querySelector('.depth3_wrap');
            if (d3Panel) d3Panel.style.maxHeight = '0px';
          });
        });

        if (isThisActive) return;

        li.classList.add('active');

        const baseHeight = panel.scrollHeight;
        panel.dataset.baseHeight = String(baseHeight);
        panel.style.maxHeight = baseHeight + 'px';
      });
    });

    // depth2 (has_depth3) 아코디언
    const depth2HasDepth3Items = moNavWrap.querySelectorAll('.depth2_list li.has_depth3');

    depth2HasDepth3Items.forEach((li) => {
      const btn = li.querySelector('.btn_depth2');
      const panel = li.querySelector('.depth3_wrap');
      if (!btn || !panel) return;

      panel.style.maxHeight = '0px';

      btn.addEventListener('click', () => {
        const parentDepth2List = li.closest('.depth2_list');
        if (!parentDepth2List) return;

        const parentDepth2Wrap = li.closest('.depth2_wrap');
        if (!parentDepth2Wrap) return;

        const siblings = parentDepth2List.querySelectorAll('li.has_depth3');
        const isThisActive = li.classList.contains('active');

        let baseHeight = parseInt(parentDepth2Wrap.dataset.baseHeight || '0', 10);
        if (isNaN(baseHeight)) baseHeight = 0;

        siblings.forEach((otherLi) => {
          const otherPanel = otherLi.querySelector('.depth3_wrap');
          otherLi.classList.remove('active');
          if (otherPanel) {
            otherPanel.style.maxHeight = '0px';
          }
        });

        if (isThisActive) {
          li.classList.remove('active');
          parentDepth2Wrap.style.maxHeight = baseHeight + 'px';
          return;
        }

        li.classList.add('active');

        const depth3Height = panel.scrollHeight;
        panel.style.maxHeight = depth3Height + 'px';

        const newHeight = baseHeight + depth3Height;
        parentDepth2Wrap.style.maxHeight = newHeight + 'px';
      });
    });
  };
  moNavAccordion();

  
</script>